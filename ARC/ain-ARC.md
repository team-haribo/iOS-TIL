# ARC

Automatic Reference Counting

컴파일러가 개발자를 대신하여 메모리를 추적하고 관리해주는 것 !

<br><br>

## Reference Counting이란 ?

인스턴스는 하나 이상의 소유자(**Owner**)가 있는 경우 메모리에 유지된다.

소유자가 없다면 그 즉시 메모리에서 제거된다.

제거 시점을 파악하기 위해 소유자 수를 저장하는데 이것을 참조 카운트(**Reference Count**)라고 한다 !

참조 카운트가 1 이상이면 메모리에 유지되고 0이 되면 메모리에서 제거된다.

<br><br>

## ARC의 동작 방식

클래스의 인스턴스가 만들어질 때 ARC는 메모리를 할당해준다.

인스턴스가 더 이상 필요하지 않을 때 ARC는 할당된 메모리를 해제한다.

ARC는 클래스 인스턴스를 참조하고 있는 프로퍼티, 상수, 변수들을 추적하고, 

만약 강한 참조가 하나라도 있다면 해제하지 않는다.

<br><br>

## 참조 방식

<br>

### 강한 참조

- 객체가 다른 객체에 강한 참조를 가지면, 참조된 객체는 메모리에서 해제되지 않는다.
- 객체가 최소 하나 이상의 강한 참조를 가지고 있을 때만 메모리에 유지된다.
- 주로 인스턴스 변수나 프로퍼티에 사용된다.

<br>

### 약한 참조

- weak 키워드로 인스턴스를 참조하면 Reference Counting 이 올라가지 않는다.
- 객체가 다른 객체에 약한 참조를 가지면, 참조된 객체가 메모리에서 해제될 수 있다.
- 약한 참조는 순환 참조를 방지하는 데 사용된다.
- 주로 델리게이트나 콜백 객체에 사용된다.

<br>

### 미소유 참조

- Unowned 키워드로 인스턴스를 참조하면 Reference Counting 이 올라가지 않는다.
- 약한 참조와 비슷하지만 참조 대상이 항상 메모리에 유효한 경우에 사용된다.

<br><br>

## 장단점

- 앱의 안정성을 높이고 메모리 관리 오류를 줄일 수 있다 !
- 코드를 보다 깔끔하고 읽기 쉽게 유지할 수 있다.
  

- 메모리 누수를 일으키는 순환 참조를 해결하기 어려울 수 있다.
